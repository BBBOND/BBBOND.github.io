{"title":"ADB的奇技淫巧","slug":"ADB-Usage","date":"2019-04-13T15:09:57.000Z","updated":"2020-02-09T15:22:37.131Z","comments":true,"path":"api/articles/ADB-Usage.json","excerpt":"ADB也就是Android Debug Bridge，是我们开发调试Android时必不可少的工具。ADB功能强大操作简单，那么就让我们一起来看下都有哪些奇技淫巧吧。Here we go！1<br>adb start-server<br>注：要是英语好，本文绝大多数命令都可以通过 adb --help 找到","covers":null,"content":"<p>ADB也就是Android Debug Bridge，是我们开发调试Android时必不可少的工具。ADB功能强大操作简单，那么就让我们一起来看下都有哪些奇技淫巧吧。Here we go！</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adb start-server</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>注：要是英语好，本文绝大多数命令都可以通过 <code>adb --help</code> 找到</p>\n</blockquote>\n<a id=\"more\"></a>\n<h2 id=\"常用命令\"><a class=\"header-anchor\" href=\"#常用命令\"></a>常用命令</h2>\n<h3 id=\"adb基本命令\"><a class=\"header-anchor\" href=\"#adb基本命令\"></a>adb基本命令</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 开启ADB服务</span></span><br><span class=\"line\">adb start-server</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关闭ADB服务</span></span><br><span class=\"line\">adb <span class=\"built_in\">kill</span>-server</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看连接的设备</span></span><br><span class=\"line\">adb devices</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装应用</span></span><br><span class=\"line\">adb install &lt;apkfile&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 卸载应用</span></span><br><span class=\"line\">adb uninstall &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 将手机中的文件下载到电脑中（前一个参数是文件在设备中的路径，后一个参数是要将文件下载到的路径）</span></span><br><span class=\"line\">adb pull /sdcard/Download/xxx ~/Desktop/</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 将电脑中的文件上传到手机中（前一个参数是文件在电脑中的路径，后一个参数是要将文件上传到的路径）</span></span><br><span class=\"line\">adb push ~/Desktop/xxx /sdcard/Download/</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启手机</span></span><br><span class=\"line\">adb reboot</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看指定 tag 日志</span></span><br><span class=\"line\">adb logcat -s &lt;tag&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 清除日志缓存</span></span><br><span class=\"line\">adb logcat -c</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过 tcp/ip 连接手机，默认端口 5555（需要在手机中开启wifi adb）</span></span><br><span class=\"line\">adb connect &lt;host:port&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"adb-shell下的命令\"><a class=\"header-anchor\" href=\"#adb-shell下的命令\"></a>adb shell下的命令</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过scheme启动APP（示例中是微信的scheme）</span></span><br><span class=\"line\">adb shell am start -d weixin://</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过包名/Activity类名启动APP</span></span><br><span class=\"line\">adb shell am start -n &lt;package/package-activity&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过包名强制停止APP</span></span><br><span class=\"line\">adb shell am force-stop &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看当前手机安装的所有包名</span></span><br><span class=\"line\">adb shell pm list packages</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 列出指定包名对应的apk路径</span></span><br><span class=\"line\">adb shell pm path &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 清空指定包名对应的应用的数据和缓存文件</span></span><br><span class=\"line\">adb shell pm clear &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 录制屏幕操作视频到sd卡并命名为 test.mp4</span></span><br><span class=\"line\"><span class=\"comment\"># 如果想停止录制，按 Ctrl + C，否则三分钟后会自动停止录制</span></span><br><span class=\"line\">adb shell screenrecord /sdcard/test.mp4</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 截屏命令</span></span><br><span class=\"line\">adb shell screencap -p /sdcard/screen.png</span><br></pre></td></tr></table></figure>\n<h2 id=\"奇技淫巧\"><a class=\"header-anchor\" href=\"#奇技淫巧\"></a>奇技淫巧</h2>\n<h3 id=\"adb基本命令-v2\"><a class=\"header-anchor\" href=\"#adb基本命令-v2\"></a>adb基本命令</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从电脑端踢出连接以强制重新连接</span></span><br><span class=\"line\">adb reconnect</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从手机端踢开连接强制重新连接</span></span><br><span class=\"line\">adb reconnect device</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重置脱机/未授权设备以强制重新连接</span></span><br><span class=\"line\">adb reconnect offline</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取当前状态 offline | bootloader | device</span></span><br><span class=\"line\">adb get-state</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 等待设备变成期待的状态</span></span><br><span class=\"line\"><span class=\"comment\"># State包含: device, recovery, sideload, or bootloader</span></span><br><span class=\"line\"><span class=\"comment\"># Transport可选包含: usb, local, or any [default=any]</span></span><br><span class=\"line\">adb <span class=\"built_in\">wait</span>-for[-TRANSPORT]-STATE</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取序列号</span></span><br><span class=\"line\">adb get-serialno</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 覆盖安装（保留数据和缓存文件，重新安装apk）</span></span><br><span class=\"line\">adb install -r &lt;apkfile&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装apk到sd卡</span></span><br><span class=\"line\">adb install -s &lt;apkfile&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 卸载app但保留数据和缓存文件</span></span><br><span class=\"line\">adb uninstall -k &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启到bootloader，即刷机模式</span></span><br><span class=\"line\">adb reboot bootloader</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启到recovery，即恢复模式</span></span><br><span class=\"line\">adb reboot recovery</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看指定 tag 日志，tag中:后面为log等级</span></span><br><span class=\"line\"><span class=\"comment\"># V—明细 D—调试 I—信息 W—警告 E—错误 F—严重错误 S—无记载</span></span><br><span class=\"line\">adb logcat &lt;tag:level&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 按照格式输出日志</span></span><br><span class=\"line\"><span class=\"comment\"># brief — 显示优先级/标记和原始进程的PID (默认格式)</span></span><br><span class=\"line\"><span class=\"comment\"># process — 仅显示进程PID</span></span><br><span class=\"line\"><span class=\"comment\"># tag — 仅显示优先级/标记</span></span><br><span class=\"line\"><span class=\"comment\"># thread — 仅显示进程：线程和优先级/标记</span></span><br><span class=\"line\"><span class=\"comment\"># raw — 显示原始的日志信息，没有其他的元数据字段</span></span><br><span class=\"line\"><span class=\"comment\"># time — 显示日期，调用时间，优先级/标记，PID</span></span><br><span class=\"line\"><span class=\"comment\"># long —显示所有的元数据字段并且用空行分隔消息内容</span></span><br><span class=\"line\">adb logcat -v &lt;format&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 选择打印日志的缓冲区</span></span><br><span class=\"line\"><span class=\"comment\"># radio — 查看包含在无线/电话相关的缓冲区消息</span></span><br><span class=\"line\"><span class=\"comment\"># events — 查看事件相关的消息</span></span><br><span class=\"line\"><span class=\"comment\"># main — 查看主缓冲区 (默认缓冲区)</span></span><br><span class=\"line\">adb logcat -b &lt;buffer&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 收集状态信息，里面包含有dmesg，dumpstate和dumpsys</span></span><br><span class=\"line\">adb bugreport &gt; bugreport.log</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 收集kernel的log凡是跟kernel相关的，比如driver出了问题（相机，蓝牙，usb，启动，等等吧）</span></span><br><span class=\"line\">adb shell dmesg &gt; ldmesg_kernel.log</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 收集所有关于系统的内容</span></span><br><span class=\"line\">adb shell dumpsys &gt; dumpsys.txt</span><br></pre></td></tr></table></figure>\n<h3 id=\"adb-shell下的命令-v2\"><a class=\"header-anchor\" href=\"#adb-shell下的命令-v2\"></a>adb shell下的命令</h3>\n<p>实际为手机目录 <code>/bin</code> 下的命令，下面主要介绍Android特有的命令，其他命令和Linux无太大差别。</p>\n<h4 id=\"am\"><a class=\"header-anchor\" href=\"#am\"></a>am</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 启动Service</span></span><br><span class=\"line\">adb shell am startservice [options] intent</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 发送广播</span></span><br><span class=\"line\">adb shell am broadcast [options] intent</span><br><span class=\"line\">adb shell am broadcast -a adnroid.intent.action.ACTION_SCREEN_ON</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 使用 Instrumentation 实例启动监控。通常，目标 component 是表单 test_package/runner_class</span></span><br><span class=\"line\">adb shell am instrument [options] component</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 强行停止与 package（应用的包名称）关联的所有应用</span></span><br><span class=\"line\">adb shell am force-stop package</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 终止与 package（应用的包名称）关联的所有进程。仅终止可安全终止且不会影响用户体验的进程。</span></span><br><span class=\"line\">adb shell am <span class=\"built_in\">kill</span> [options] package</span><br></pre></td></tr></table></figure>\n<h4 id=\"ifconfig\"><a class=\"header-anchor\" href=\"#ifconfig\"></a>ifconfig</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># WIFI状态下查看当前IP</span></span><br><span class=\"line\">adb shell ifconfig | grep 192.168</span><br></pre></td></tr></table></figure>\n<h4 id=\"dumpsys\"><a class=\"header-anchor\" href=\"#dumpsys\"></a>dumpsys</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看最上层Activity名字</span></span><br><span class=\"line\">adb shell dumpsys activity activities | grep mResumedActivity</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看最上层Activity名字</span></span><br><span class=\"line\">adb shell dumpsys window w | grep / | grep name=</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看Activity的任务栈</span></span><br><span class=\"line\">adb shell dumpsys activity activities</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示所有的activities的信息,包括任务栈等:</span></span><br><span class=\"line\">adb shell dumpsys activity</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示accounts信息</span></span><br><span class=\"line\">adb shell dumpsys account</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示CPU信息</span></span><br><span class=\"line\">adb shell dumpsys cpuinfo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示wifi信息</span></span><br><span class=\"line\">adb shell dumpsys wifi</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示键盘，窗口以及它们的关系</span></span><br><span class=\"line\">adb shell dumpsys window</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示分辨率</span></span><br><span class=\"line\">adb shell dumpsys window displays | grep DisplayFrames</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看UI绘制的各个层级信息</span></span><br><span class=\"line\">adb shell dumpsys SurfaceFlinger</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看耗电量</span></span><br><span class=\"line\">adb shell dumpsys batterystats &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取安装包信息</span></span><br><span class=\"line\">adb shell dumpsys package &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看每个应用的启动次数和时间</span></span><br><span class=\"line\">adb shell dumpsys usagestats &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示状态栏相关的信息</span></span><br><span class=\"line\">adb shell dumpsys statusbar</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示内存信息</span></span><br><span class=\"line\">adb shell dumpsys meminfo &lt;package/pid&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示磁盘相关信息</span></span><br><span class=\"line\">adb shell dumpsys diskstats</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示电池相关信息</span></span><br><span class=\"line\">adb shell dumpsys battery</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示Alarm信息</span></span><br><span class=\"line\">adb shell dumpsys alarm</span><br></pre></td></tr></table></figure>\n<h4 id=\"cat\"><a class=\"header-anchor\" href=\"#cat\"></a>cat</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看内存信息</span></span><br><span class=\"line\">adb shell cat proc/meminfo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 指定进程内存地址映射</span></span><br><span class=\"line\">adb shell cat proc/&lt;pid&gt;/maps</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 指定进程内存详细使用信息</span></span><br><span class=\"line\">adb shell cat proc/&lt;pid&gt;/smaps</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取CPU信息</span></span><br><span class=\"line\">adb shell cat /proc/cpuinfo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># --------- 需要root ---------</span></span><br><span class=\"line\"></span><br><span class=\"line\">adb shell</span><br><span class=\"line\">su</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取机器MAC地址 按下面命令顺序执行(需要root的设备)</span></span><br><span class=\"line\">cat /sys/class/net/wlan0/address</span><br><span class=\"line\"><span class=\"comment\"># 查看IO内存分区</span></span><br><span class=\"line\">cat /proc/iomem</span><br><span class=\"line\"><span class=\"comment\"># 查看wifi密码</span></span><br><span class=\"line\">cat /data/misc/wifi/WifiConfigStore.xml</span><br><span class=\"line\"><span class=\"comment\"># 查看设备信息</span></span><br><span class=\"line\">cat /system/build.prop</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">exit</span></span><br><span class=\"line\"><span class=\"built_in\">exit</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"getevent\"><a class=\"header-anchor\" href=\"#getevent\"></a>getevent</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看可输入的设备</span></span><br><span class=\"line\">adb shell getevent -p</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获得特定设备的输入信息</span></span><br><span class=\"line\">adb shell getevent &lt;/dev/input/event0&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"input\"><a class=\"header-anchor\" href=\"#input\"></a>input</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 点击</span></span><br><span class=\"line\">adb shell input tap &lt;x&gt; &lt;y&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 模拟按键 82为菜单键</span></span><br><span class=\"line\">adb shell input keyevent &lt;keycode&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输入文本</span></span><br><span class=\"line\">adb shell input text XXXX</span><br></pre></td></tr></table></figure>\n<h4 id=\"ps\"><a class=\"header-anchor\" href=\"#ps\"></a>ps</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看相应包名的进程</span></span><br><span class=\"line\">adb shell ps | grep &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"service\"><a class=\"header-anchor\" href=\"#service\"></a>service</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看后台services信息</span></span><br><span class=\"line\">adb shell service list</span><br></pre></td></tr></table></figure>\n<h4 id=\"screenrecord\"><a class=\"header-anchor\" href=\"#screenrecord\"></a>screenrecord</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 限制视频录制时间为10s,如果不限制,默认180s</span></span><br><span class=\"line\">adb shell screenrecord  --time-limit 10 /sdcard/demo.mp4</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定视频分辨率大小</span></span><br><span class=\"line\">adb shell screenrecord --size 1280*720 /sdcard/demo.mp4</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定视频的比特率:</span></span><br><span class=\"line\">adb shell screenrecord --bit-rate 6000000 /sdcard/demo.mp4</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 在命令行显示log</span></span><br><span class=\"line\">adb shell screenrecord --time-limit 10 --verbose /sdcard/Download/demo.mp4</span><br></pre></td></tr></table></figure>\n<h4 id=\"getprop\"><a class=\"header-anchor\" href=\"#getprop\"></a>getprop</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取属性信息</span></span><br><span class=\"line\">adb shell getprop &lt;key&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"monkey\"><a class=\"header-anchor\" href=\"#monkey\"></a>monkey</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># usage: monkey</span></span><br><span class=\"line\"><span class=\"comment\"># [-p ALLOWED_PACKAGE [-p ALLOWED_PACKAGE] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [-c MAIN_CATEGORY [-c MAIN_CATEGORY] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [--ignore-crashes] [--ignore-timeouts]</span></span><br><span class=\"line\"><span class=\"comment\"># [--ignore-security-exceptions]</span></span><br><span class=\"line\"><span class=\"comment\"># [--monitor-native-crashes] [--ignore-native-crashes]</span></span><br><span class=\"line\"><span class=\"comment\"># [--kill-process-after-error] [--hprof]</span></span><br><span class=\"line\"><span class=\"comment\"># [--match-description TEXT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-touch PERCENT] [--pct-motion PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-trackball PERCENT] [--pct-syskeys PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-nav PERCENT] [--pct-majornav PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-appswitch PERCENT] [--pct-flip PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-anyevent PERCENT] [--pct-pinchzoom PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-permission PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pkg-blacklist-file PACKAGE_BLACKLIST_FILE]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pkg-whitelist-file PACKAGE_WHITELIST_FILE]</span></span><br><span class=\"line\"><span class=\"comment\"># [--wait-dbg] [--dbg-no-events]</span></span><br><span class=\"line\"><span class=\"comment\"># [--setup scriptfile] [-f scriptfile [-f scriptfile] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [--port port]</span></span><br><span class=\"line\"><span class=\"comment\"># [-s SEED] [-v [-v] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [--throttle MILLISEC] [--randomize-throttle]</span></span><br><span class=\"line\"><span class=\"comment\"># [--profile-wait MILLISEC]</span></span><br><span class=\"line\"><span class=\"comment\"># [--device-sleep-time MILLISEC]</span></span><br><span class=\"line\"><span class=\"comment\"># [--randomize-script]</span></span><br><span class=\"line\"><span class=\"comment\"># [--script-log]</span></span><br><span class=\"line\"><span class=\"comment\"># [--bugreport]</span></span><br><span class=\"line\"><span class=\"comment\"># [--periodic-bugreport]</span></span><br><span class=\"line\"><span class=\"comment\"># [--permission-target-system]</span></span><br><span class=\"line\"><span class=\"comment\"># COUNT</span></span><br><span class=\"line\">adb shell monkey -p &lt;package&gt; 500</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th>基本参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-p</td>\n<td><allowed-package-name>指定一个或多个包</allowed-package-name></td>\n</tr>\n<tr>\n<td>-s</td>\n<td><seed> 指定一个随机数生成器的seed值</seed></td>\n</tr>\n<tr>\n<td>–throttle</td>\n<td><milliseconds> 指定事件之间的固定延迟（ms）</milliseconds></td>\n</tr>\n<tr>\n<td>-v</td>\n<td>指定反馈信息级别（信息级别就是日志的详细程度）</td>\n</tr>\n<tr>\n<td>-c</td>\n<td><main-category> 指定一个或多个类别名</main-category></td>\n</tr>\n<tr>\n<td>-f</td>\n<td><scriptfile> 运行指定的monkey脚本</scriptfile></td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th>事件参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>–pct-touch</td>\n<td><percent> 指定触摸事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-motion</td>\n<td><percent> 指定动作事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-trackball</td>\n<td><percent> 指定轨迹事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-syskeys</td>\n<td><percent> 指定系统按键事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-nav</td>\n<td><percent> 指定基本导航事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-majornav</td>\n<td><percent> 指定主要导航事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-appswitch</td>\n<td><percent> 指定应用启动事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-flip</td>\n<td><percent> 指定flip(弹)事件的百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-anyevent</td>\n<td><percent> 指定其他类型事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-pinchzoom</td>\n<td><percent> 指定缩放(捏)事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-permission</td>\n<td><percent> 指定权限</percent></td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th>调试参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>–ignore-crashes</td>\n<td>忽略因崩溃或异常引起的停止运行</td>\n</tr>\n<tr>\n<td>–ignore-timeouts</td>\n<td>忽略应用发生超时错误（ANR)</td>\n</tr>\n<tr>\n<td>–ignore-security-exceptions</td>\n<td>忽略应用发生任何权限错误</td>\n</tr>\n<tr>\n<td>–monitor-native-crashes</td>\n<td>监视并报告monkey运行时native code的崩溃事件</td>\n</tr>\n<tr>\n<td>–ignore-native-crashes</td>\n<td>忽略因native code的崩溃事件</td>\n</tr>\n<tr>\n<td>–kill-process-after-error</td>\n<td>在应用出错后通知系统杀死发生错误的进程</td>\n</tr>\n<tr>\n<td>–hprof</td>\n<td>在事件序列前后立即生成profilfing report</td>\n</tr>\n<tr>\n<td>–dbg-no-events</td>\n<td>监视应用程序所调用的包之间的转换</td>\n</tr>\n<tr>\n<td>–wait-dbg</td>\n<td>暂停执行中的monkey，直到有调试器与它连接</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"其他工具\"><a class=\"header-anchor\" href=\"#其他工具\"></a>其他工具</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看Android应用包名package和入口activity名称</span></span><br><span class=\"line\">aapt dump badging ~/Downloads/app-release.apk</span><br></pre></td></tr></table></figure>","more":"<h2 id=\"常用命令\"><a class=\"header-anchor\" href=\"#常用命令\"></a>常用命令</h2>\n<h3 id=\"adb基本命令\"><a class=\"header-anchor\" href=\"#adb基本命令\"></a>adb基本命令</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 开启ADB服务</span></span><br><span class=\"line\">adb start-server</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关闭ADB服务</span></span><br><span class=\"line\">adb <span class=\"built_in\">kill</span>-server</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看连接的设备</span></span><br><span class=\"line\">adb devices</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装应用</span></span><br><span class=\"line\">adb install &lt;apkfile&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 卸载应用</span></span><br><span class=\"line\">adb uninstall &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 将手机中的文件下载到电脑中（前一个参数是文件在设备中的路径，后一个参数是要将文件下载到的路径）</span></span><br><span class=\"line\">adb pull /sdcard/Download/xxx ~/Desktop/</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 将电脑中的文件上传到手机中（前一个参数是文件在电脑中的路径，后一个参数是要将文件上传到的路径）</span></span><br><span class=\"line\">adb push ~/Desktop/xxx /sdcard/Download/</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启手机</span></span><br><span class=\"line\">adb reboot</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看指定 tag 日志</span></span><br><span class=\"line\">adb logcat -s &lt;tag&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 清除日志缓存</span></span><br><span class=\"line\">adb logcat -c</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过 tcp/ip 连接手机，默认端口 5555（需要在手机中开启wifi adb）</span></span><br><span class=\"line\">adb connect &lt;host:port&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"adb-shell下的命令\"><a class=\"header-anchor\" href=\"#adb-shell下的命令\"></a>adb shell下的命令</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过scheme启动APP（示例中是微信的scheme）</span></span><br><span class=\"line\">adb shell am start -d weixin://</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过包名/Activity类名启动APP</span></span><br><span class=\"line\">adb shell am start -n &lt;package/package-activity&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过包名强制停止APP</span></span><br><span class=\"line\">adb shell am force-stop &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看当前手机安装的所有包名</span></span><br><span class=\"line\">adb shell pm list packages</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 列出指定包名对应的apk路径</span></span><br><span class=\"line\">adb shell pm path &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 清空指定包名对应的应用的数据和缓存文件</span></span><br><span class=\"line\">adb shell pm clear &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 录制屏幕操作视频到sd卡并命名为 test.mp4</span></span><br><span class=\"line\"><span class=\"comment\"># 如果想停止录制，按 Ctrl + C，否则三分钟后会自动停止录制</span></span><br><span class=\"line\">adb shell screenrecord /sdcard/test.mp4</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 截屏命令</span></span><br><span class=\"line\">adb shell screencap -p /sdcard/screen.png</span><br></pre></td></tr></table></figure>\n<h2 id=\"奇技淫巧\"><a class=\"header-anchor\" href=\"#奇技淫巧\"></a>奇技淫巧</h2>\n<h3 id=\"adb基本命令-v2\"><a class=\"header-anchor\" href=\"#adb基本命令-v2\"></a>adb基本命令</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从电脑端踢出连接以强制重新连接</span></span><br><span class=\"line\">adb reconnect</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从手机端踢开连接强制重新连接</span></span><br><span class=\"line\">adb reconnect device</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重置脱机/未授权设备以强制重新连接</span></span><br><span class=\"line\">adb reconnect offline</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取当前状态 offline | bootloader | device</span></span><br><span class=\"line\">adb get-state</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 等待设备变成期待的状态</span></span><br><span class=\"line\"><span class=\"comment\"># State包含: device, recovery, sideload, or bootloader</span></span><br><span class=\"line\"><span class=\"comment\"># Transport可选包含: usb, local, or any [default=any]</span></span><br><span class=\"line\">adb <span class=\"built_in\">wait</span>-for[-TRANSPORT]-STATE</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取序列号</span></span><br><span class=\"line\">adb get-serialno</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 覆盖安装（保留数据和缓存文件，重新安装apk）</span></span><br><span class=\"line\">adb install -r &lt;apkfile&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装apk到sd卡</span></span><br><span class=\"line\">adb install -s &lt;apkfile&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 卸载app但保留数据和缓存文件</span></span><br><span class=\"line\">adb uninstall -k &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启到bootloader，即刷机模式</span></span><br><span class=\"line\">adb reboot bootloader</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启到recovery，即恢复模式</span></span><br><span class=\"line\">adb reboot recovery</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看指定 tag 日志，tag中:后面为log等级</span></span><br><span class=\"line\"><span class=\"comment\"># V—明细 D—调试 I—信息 W—警告 E—错误 F—严重错误 S—无记载</span></span><br><span class=\"line\">adb logcat &lt;tag:level&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 按照格式输出日志</span></span><br><span class=\"line\"><span class=\"comment\"># brief — 显示优先级/标记和原始进程的PID (默认格式)</span></span><br><span class=\"line\"><span class=\"comment\"># process — 仅显示进程PID</span></span><br><span class=\"line\"><span class=\"comment\"># tag — 仅显示优先级/标记</span></span><br><span class=\"line\"><span class=\"comment\"># thread — 仅显示进程：线程和优先级/标记</span></span><br><span class=\"line\"><span class=\"comment\"># raw — 显示原始的日志信息，没有其他的元数据字段</span></span><br><span class=\"line\"><span class=\"comment\"># time — 显示日期，调用时间，优先级/标记，PID</span></span><br><span class=\"line\"><span class=\"comment\"># long —显示所有的元数据字段并且用空行分隔消息内容</span></span><br><span class=\"line\">adb logcat -v &lt;format&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 选择打印日志的缓冲区</span></span><br><span class=\"line\"><span class=\"comment\"># radio — 查看包含在无线/电话相关的缓冲区消息</span></span><br><span class=\"line\"><span class=\"comment\"># events — 查看事件相关的消息</span></span><br><span class=\"line\"><span class=\"comment\"># main — 查看主缓冲区 (默认缓冲区)</span></span><br><span class=\"line\">adb logcat -b &lt;buffer&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 收集状态信息，里面包含有dmesg，dumpstate和dumpsys</span></span><br><span class=\"line\">adb bugreport &gt; bugreport.log</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 收集kernel的log凡是跟kernel相关的，比如driver出了问题（相机，蓝牙，usb，启动，等等吧）</span></span><br><span class=\"line\">adb shell dmesg &gt; ldmesg_kernel.log</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 收集所有关于系统的内容</span></span><br><span class=\"line\">adb shell dumpsys &gt; dumpsys.txt</span><br></pre></td></tr></table></figure>\n<h3 id=\"adb-shell下的命令-v2\"><a class=\"header-anchor\" href=\"#adb-shell下的命令-v2\"></a>adb shell下的命令</h3>\n<p>实际为手机目录 <code>/bin</code> 下的命令，下面主要介绍Android特有的命令，其他命令和Linux无太大差别。</p>\n<h4 id=\"am\"><a class=\"header-anchor\" href=\"#am\"></a>am</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 启动Service</span></span><br><span class=\"line\">adb shell am startservice [options] intent</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 发送广播</span></span><br><span class=\"line\">adb shell am broadcast [options] intent</span><br><span class=\"line\">adb shell am broadcast -a adnroid.intent.action.ACTION_SCREEN_ON</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 使用 Instrumentation 实例启动监控。通常，目标 component 是表单 test_package/runner_class</span></span><br><span class=\"line\">adb shell am instrument [options] component</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 强行停止与 package（应用的包名称）关联的所有应用</span></span><br><span class=\"line\">adb shell am force-stop package</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 终止与 package（应用的包名称）关联的所有进程。仅终止可安全终止且不会影响用户体验的进程。</span></span><br><span class=\"line\">adb shell am <span class=\"built_in\">kill</span> [options] package</span><br></pre></td></tr></table></figure>\n<h4 id=\"ifconfig\"><a class=\"header-anchor\" href=\"#ifconfig\"></a>ifconfig</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># WIFI状态下查看当前IP</span></span><br><span class=\"line\">adb shell ifconfig | grep 192.168</span><br></pre></td></tr></table></figure>\n<h4 id=\"dumpsys\"><a class=\"header-anchor\" href=\"#dumpsys\"></a>dumpsys</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看最上层Activity名字</span></span><br><span class=\"line\">adb shell dumpsys activity activities | grep mResumedActivity</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看最上层Activity名字</span></span><br><span class=\"line\">adb shell dumpsys window w | grep / | grep name=</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看Activity的任务栈</span></span><br><span class=\"line\">adb shell dumpsys activity activities</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示所有的activities的信息,包括任务栈等:</span></span><br><span class=\"line\">adb shell dumpsys activity</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示accounts信息</span></span><br><span class=\"line\">adb shell dumpsys account</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示CPU信息</span></span><br><span class=\"line\">adb shell dumpsys cpuinfo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示wifi信息</span></span><br><span class=\"line\">adb shell dumpsys wifi</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示键盘，窗口以及它们的关系</span></span><br><span class=\"line\">adb shell dumpsys window</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示分辨率</span></span><br><span class=\"line\">adb shell dumpsys window displays | grep DisplayFrames</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看UI绘制的各个层级信息</span></span><br><span class=\"line\">adb shell dumpsys SurfaceFlinger</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看耗电量</span></span><br><span class=\"line\">adb shell dumpsys batterystats &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取安装包信息</span></span><br><span class=\"line\">adb shell dumpsys package &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看每个应用的启动次数和时间</span></span><br><span class=\"line\">adb shell dumpsys usagestats &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示状态栏相关的信息</span></span><br><span class=\"line\">adb shell dumpsys statusbar</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示内存信息</span></span><br><span class=\"line\">adb shell dumpsys meminfo &lt;package/pid&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示磁盘相关信息</span></span><br><span class=\"line\">adb shell dumpsys diskstats</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示电池相关信息</span></span><br><span class=\"line\">adb shell dumpsys battery</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示Alarm信息</span></span><br><span class=\"line\">adb shell dumpsys alarm</span><br></pre></td></tr></table></figure>\n<h4 id=\"cat\"><a class=\"header-anchor\" href=\"#cat\"></a>cat</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看内存信息</span></span><br><span class=\"line\">adb shell cat proc/meminfo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 指定进程内存地址映射</span></span><br><span class=\"line\">adb shell cat proc/&lt;pid&gt;/maps</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 指定进程内存详细使用信息</span></span><br><span class=\"line\">adb shell cat proc/&lt;pid&gt;/smaps</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取CPU信息</span></span><br><span class=\"line\">adb shell cat /proc/cpuinfo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># --------- 需要root ---------</span></span><br><span class=\"line\"></span><br><span class=\"line\">adb shell</span><br><span class=\"line\">su</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取机器MAC地址 按下面命令顺序执行(需要root的设备)</span></span><br><span class=\"line\">cat /sys/class/net/wlan0/address</span><br><span class=\"line\"><span class=\"comment\"># 查看IO内存分区</span></span><br><span class=\"line\">cat /proc/iomem</span><br><span class=\"line\"><span class=\"comment\"># 查看wifi密码</span></span><br><span class=\"line\">cat /data/misc/wifi/WifiConfigStore.xml</span><br><span class=\"line\"><span class=\"comment\"># 查看设备信息</span></span><br><span class=\"line\">cat /system/build.prop</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">exit</span></span><br><span class=\"line\"><span class=\"built_in\">exit</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"getevent\"><a class=\"header-anchor\" href=\"#getevent\"></a>getevent</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看可输入的设备</span></span><br><span class=\"line\">adb shell getevent -p</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获得特定设备的输入信息</span></span><br><span class=\"line\">adb shell getevent &lt;/dev/input/event0&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"input\"><a class=\"header-anchor\" href=\"#input\"></a>input</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 点击</span></span><br><span class=\"line\">adb shell input tap &lt;x&gt; &lt;y&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 模拟按键 82为菜单键</span></span><br><span class=\"line\">adb shell input keyevent &lt;keycode&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输入文本</span></span><br><span class=\"line\">adb shell input text XXXX</span><br></pre></td></tr></table></figure>\n<h4 id=\"ps\"><a class=\"header-anchor\" href=\"#ps\"></a>ps</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看相应包名的进程</span></span><br><span class=\"line\">adb shell ps | grep &lt;package&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"service\"><a class=\"header-anchor\" href=\"#service\"></a>service</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看后台services信息</span></span><br><span class=\"line\">adb shell service list</span><br></pre></td></tr></table></figure>\n<h4 id=\"screenrecord\"><a class=\"header-anchor\" href=\"#screenrecord\"></a>screenrecord</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 限制视频录制时间为10s,如果不限制,默认180s</span></span><br><span class=\"line\">adb shell screenrecord  --time-limit 10 /sdcard/demo.mp4</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定视频分辨率大小</span></span><br><span class=\"line\">adb shell screenrecord --size 1280*720 /sdcard/demo.mp4</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定视频的比特率:</span></span><br><span class=\"line\">adb shell screenrecord --bit-rate 6000000 /sdcard/demo.mp4</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 在命令行显示log</span></span><br><span class=\"line\">adb shell screenrecord --time-limit 10 --verbose /sdcard/Download/demo.mp4</span><br></pre></td></tr></table></figure>\n<h4 id=\"getprop\"><a class=\"header-anchor\" href=\"#getprop\"></a>getprop</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 获取属性信息</span></span><br><span class=\"line\">adb shell getprop &lt;key&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"monkey\"><a class=\"header-anchor\" href=\"#monkey\"></a>monkey</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># usage: monkey</span></span><br><span class=\"line\"><span class=\"comment\"># [-p ALLOWED_PACKAGE [-p ALLOWED_PACKAGE] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [-c MAIN_CATEGORY [-c MAIN_CATEGORY] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [--ignore-crashes] [--ignore-timeouts]</span></span><br><span class=\"line\"><span class=\"comment\"># [--ignore-security-exceptions]</span></span><br><span class=\"line\"><span class=\"comment\"># [--monitor-native-crashes] [--ignore-native-crashes]</span></span><br><span class=\"line\"><span class=\"comment\"># [--kill-process-after-error] [--hprof]</span></span><br><span class=\"line\"><span class=\"comment\"># [--match-description TEXT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-touch PERCENT] [--pct-motion PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-trackball PERCENT] [--pct-syskeys PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-nav PERCENT] [--pct-majornav PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-appswitch PERCENT] [--pct-flip PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-anyevent PERCENT] [--pct-pinchzoom PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pct-permission PERCENT]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pkg-blacklist-file PACKAGE_BLACKLIST_FILE]</span></span><br><span class=\"line\"><span class=\"comment\"># [--pkg-whitelist-file PACKAGE_WHITELIST_FILE]</span></span><br><span class=\"line\"><span class=\"comment\"># [--wait-dbg] [--dbg-no-events]</span></span><br><span class=\"line\"><span class=\"comment\"># [--setup scriptfile] [-f scriptfile [-f scriptfile] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [--port port]</span></span><br><span class=\"line\"><span class=\"comment\"># [-s SEED] [-v [-v] ...]</span></span><br><span class=\"line\"><span class=\"comment\"># [--throttle MILLISEC] [--randomize-throttle]</span></span><br><span class=\"line\"><span class=\"comment\"># [--profile-wait MILLISEC]</span></span><br><span class=\"line\"><span class=\"comment\"># [--device-sleep-time MILLISEC]</span></span><br><span class=\"line\"><span class=\"comment\"># [--randomize-script]</span></span><br><span class=\"line\"><span class=\"comment\"># [--script-log]</span></span><br><span class=\"line\"><span class=\"comment\"># [--bugreport]</span></span><br><span class=\"line\"><span class=\"comment\"># [--periodic-bugreport]</span></span><br><span class=\"line\"><span class=\"comment\"># [--permission-target-system]</span></span><br><span class=\"line\"><span class=\"comment\"># COUNT</span></span><br><span class=\"line\">adb shell monkey -p &lt;package&gt; 500</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th>基本参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-p</td>\n<td><allowed-package-name>指定一个或多个包</allowed-package-name></td>\n</tr>\n<tr>\n<td>-s</td>\n<td><seed> 指定一个随机数生成器的seed值</seed></td>\n</tr>\n<tr>\n<td>–throttle</td>\n<td><milliseconds> 指定事件之间的固定延迟（ms）</milliseconds></td>\n</tr>\n<tr>\n<td>-v</td>\n<td>指定反馈信息级别（信息级别就是日志的详细程度）</td>\n</tr>\n<tr>\n<td>-c</td>\n<td><main-category> 指定一个或多个类别名</main-category></td>\n</tr>\n<tr>\n<td>-f</td>\n<td><scriptfile> 运行指定的monkey脚本</scriptfile></td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th>事件参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>–pct-touch</td>\n<td><percent> 指定触摸事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-motion</td>\n<td><percent> 指定动作事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-trackball</td>\n<td><percent> 指定轨迹事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-syskeys</td>\n<td><percent> 指定系统按键事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-nav</td>\n<td><percent> 指定基本导航事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-majornav</td>\n<td><percent> 指定主要导航事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-appswitch</td>\n<td><percent> 指定应用启动事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-flip</td>\n<td><percent> 指定flip(弹)事件的百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-anyevent</td>\n<td><percent> 指定其他类型事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-pinchzoom</td>\n<td><percent> 指定缩放(捏)事件百分比</percent></td>\n</tr>\n<tr>\n<td>–pct-permission</td>\n<td><percent> 指定权限</percent></td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th>调试参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>–ignore-crashes</td>\n<td>忽略因崩溃或异常引起的停止运行</td>\n</tr>\n<tr>\n<td>–ignore-timeouts</td>\n<td>忽略应用发生超时错误（ANR)</td>\n</tr>\n<tr>\n<td>–ignore-security-exceptions</td>\n<td>忽略应用发生任何权限错误</td>\n</tr>\n<tr>\n<td>–monitor-native-crashes</td>\n<td>监视并报告monkey运行时native code的崩溃事件</td>\n</tr>\n<tr>\n<td>–ignore-native-crashes</td>\n<td>忽略因native code的崩溃事件</td>\n</tr>\n<tr>\n<td>–kill-process-after-error</td>\n<td>在应用出错后通知系统杀死发生错误的进程</td>\n</tr>\n<tr>\n<td>–hprof</td>\n<td>在事件序列前后立即生成profilfing report</td>\n</tr>\n<tr>\n<td>–dbg-no-events</td>\n<td>监视应用程序所调用的包之间的转换</td>\n</tr>\n<tr>\n<td>–wait-dbg</td>\n<td>暂停执行中的monkey，直到有调试器与它连接</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"其他工具\"><a class=\"header-anchor\" href=\"#其他工具\"></a>其他工具</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看Android应用包名package和入口activity名称</span></span><br><span class=\"line\">aapt dump badging ~/Downloads/app-release.apk</span><br></pre></td></tr></table></figure>","categories":[],"tags":[{"name":"android","path":"api/tags/android.json"},{"name":"工具","path":"api/tags/工具.json"}]}